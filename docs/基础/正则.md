在本文中，你将了解：

- 正则分离`?`前后字符，`正则.exec`,如：`/.+\?(.+)$/.exec('xx?aa=345&bb=123')`
  -  返回 `["xx?aa=345&bb=123", "aa=345&bb=123", ...]`, 只给后面`(.+)`加了括号，所以只有一个分组，index = 1 对应`?`后的字符串
- 正则判断全是数字，`正则.test`,如：`/^\d+$/.test(val)`

- `match`，--> `str.match(/ain/g); // ['ain', 'ain', 'ain']`
- `replace` 若 replaceStr 为函数，则这个函数的第一个参数：`匹配到的字符串`，后面参数为`分组`
  - `'target[2].a'.replace(/\[(.)\]/g, '.$1.')` ，替换`[xxx]`为`.xxx.`,打印：`'target.2..a'` 
- `decodeURIComponent`是解码

- `toUpperCase`：把字符串转换为大写；`toLowerCase`：把字符串转换为小写


## 正则知识

`/reg/.fn(string)`和`string.fn(/reg/)`

### RegExp 对象方法



| 方法 | 描述 |
| ---  | --- |
| [exec](https://www.runoob.com/jsref/jsref-exec-regexp.html)| 如果字符串中有匹配的值返回该匹配值，否则返回 null，如：` /.+\?(.+)$/.exec('xx?aa=345&bb=123')` </br> 1. 返回 `["xx?aa=345&bb=123", "aa=345&bb=123", ...]`</br> 2. index = 0 对应`/.+\?(.+)$/`, index = 1 对应`(.+)` </br>3. 第 0 个值是匹配的字符串，后面的 1,2..是分组 |
| [test](https://www.runoob.com/jsref/jsref-test-regexp.html) | test() 方法用于检测一个字符串是否匹配某个模式，如： `/=/.test('open=true')` |

### 支持正则的 String 方法

| 方法 | 描述 |
| ---  | --- |
| [match](https://www.runoob.com/jsref/jsref-match.html) | 找到一个或多个正则表达式的匹配，如：`str.match(/ain/g); // ['ain', 'ain', 'ain']` |
| [replace](https://www.runoob.com/jsref/jsref-replace.html) | `s.replace(search,replaceStr)`,若`replaceStr`为函数，则这个函数的第一个参数：`匹配到的字符串`，中间参数为`分组`，例如：`'target[2].a'.replace(/\[(.)\]/g, '.$1.')` ，替换`[xxx]`为`.xxx.`,打印：`'target.2..a'` |
| [search](https://www.runoob.com/jsref/jsref-search.html) | 同`indexOf`，区别是可以传正则 |
| [split](https://www.runoob.com/jsref/jsref-split.html) | 可传入正则|


```js
// match
let str="The rain in SPAIN stays mainly in the plain"; 
str.match(/ain/g); // ['ain', 'ain', 'ain']
str.match(/ain/); // ['ain']

// search
let str="Mr. Blue has a blue house";
str.search("blue") // 15
```

* `match`赖于 `regexp` 是否具有标志 `g`,无则返回一个，有则返回多个

### 元字符

| 元字符 | 描述 |
| ---   | --- |
| `\w` | 查找数字、字母及下划线
| `\d` |  数字
| `\s` | 空格
| `.` | 可以匹配任意字符 |

### 方括号

| 表达式 | 描述 |
| ---   | --- |
| `n*` | `n >= 0`, 零个或多个 n 的字符串 |
| `n+` | `n >= 1`, 表示至少一个字符 |
| `n？` | `n == 0 || n == 1`, 表示 0 个或 1 个字符 |
| `{n}` | 表示 n 个字符，`{n,m}`表示 n-m 个字符，如：`\d{3,8}`表示 3-8 个数字，例如'1234567'|
|`[abc]`|查找方括号之间的任何字符。
|`[^abc]`|查找任何不在方括号之间的字符。
|`[0-9]`| 查找任何从 0 至 9 的数字。
|`[a-z]`| 查找任何从小写 a 到小写 z 的字符。

### 量词

| 量词 | 描述 |
| ---   | --- |
|`n$`| 匹配任何结尾为 n 的字符串。
|`^n`| 匹配任何开头为 n 的字符串。

### 修饰符

| 修饰符 | 描述 |
| ---   | --- |
| `i` | 大小写不敏感 |
| `g` | 全局匹配 |
| `m` | 多行匹配 |

### 来几个例子

## 练手题目

### 解析 URL Params 为对象

#### 面试够用版

```js
function parse_url(_url){ //定义函数
　　var pattern = /(\w+)=(\w+)/ig;//定义正则表达式
　　var parames = {};//定义数组
　　url.replace(pattern, function(a, b, c){
　　　　parames[b] = c;
　　});
　　return parames;//返回这个数组。
}

var  url = "http://www.baidu.com?name=elephant&age=25&sex=male" 
var params = parse_url(url);// ["name=elephant", "age=25", "sex=male"]
```

*但不能处理`UTF-8`、`空格`这样的参数

#### 完整版

```js
function parseParam(url) {
  // 得到 search
  const str = /.+\?(.+)$/.exec(url)[1];
  const arr = str.split('&');
  let paramsObj = {};

  arr.forEach(item => {
    let [key, val] = item.split('='); 
    paramsObj[key] = deal(val);
  })

  return paramsObj;
}

function deal(s) {
  // 未设置 value，则为 true
  if(!s) return true;
  s = decodeURIComponent(s);
  // 判断是否转为数字
  s = /^\d+$/.test(s) ? Number(s) : s;
  return s;
}

// let path = 'https://www.baidu.com/s?open&ie=UTF-8&wd=URL%20Params%20%E4%B8%BA%E5%AF%B9%E8%B1%A1';
// console.log(parseParam(path)); //{"open":true, "ie":"UTF-8", "wd":"URL Params 为对象"}

```

### 模板引擎实现

`replace` 举例：替换字符串传了一个函数，这个函数的第一个参数：匹配到的字符串，中间参数为分组

```js
function render(template, data) {
  const reg = /\{\{(\w+)\}\}/g;
  const replaceStr = template.replace(reg, (target, w) => {
    // 如：target: {{age}} w: 18
    return data[w];
  });
  return replaceStr;
}

// let template = '我是{{name}}，年龄{{age}}，性别{{sex}}';
// let data = {
//   name: '姓名',
//   age: 18
// }
// render(template, data); // 我是姓名，年龄 18，性别 undefined

```

### 转化驼峰

- `toUpperCase`：把字符串转换为大写
- `toLowerCase`：把字符串转换为小写

```js
let f = function(s) {
  // 使用分组，匹配到了 '-e',但\w有括号，所以就是第一个参数
  // text: -e, firstWord: e
  return s.replace(/-(\w{1})/g, (text, firstWord) => {
    console.log('text, firstWord: ', text, firstWord);
    return firstWord.toUpperCase();
  });
  // 下面是正则没有使用分组
  // return s.replace(/-\w/g, function(x) {
  //   return x.slice(1).toUpperCase();
  // })
}

var s1 = "get-element-by-id";
console.log(f(s1)); // getElementById
```

### 扁平 path 从 object 取值

```js
const get = (from, ...selectors) =>
  [...selectors].map(s =>
    s
      // 标准答案里的正则匹配应该这样，/\[([^\[\]]*)\]/g ，下面是简化版
      .replace(/\[(.)\]/g, '.$1.')
      .replace(, '.$1.')
      .split('.')
      .filter(t => t !== '')
      .reduce((prev, cur) => prev && prev[cur], from)
  );

// Examples
const obj = {
  selector: { to: { val: 'val to select' } },
  target: [1, 2, { a: 'test' }],
};
get(obj, 'selector.to.val', 'target[0]', 'target[2].a'); // ['val to select', 1, 'test']
```

分析一下标准答案的正则——`/\[([^\[\]]*)\]/g`:

1. 匹配`[]`，用`\[`与`\]`
2. 匹配`[xxx]`里的东西`xxx`,用分组`()`
3. `xxx` 不能是`\[`与`\]`，用 [^abc],查找任何不在方括号之间的字符
4. `xxx` 的数量 0 或多个，用`*`
5. 最后，`$1`表被匹配到的 `xxx`

简单点做，我用的`/\[(.)\]/g`来匹配


## 参考

[菜鸟](https://www.runoob.com/jsref/jsref-obj-regexp.html)

[阮一峰](https://www.liaoxuefeng.com/wiki/1016959663602400/1017639890281664)